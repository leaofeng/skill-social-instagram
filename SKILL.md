# Instagram Downloader Skill

ä¸‹è½½ Instagram **å›¾ç‰‡** å’Œ **è§†é¢‘** å¹¶å‘é€åˆ° Telegram

**æ”¯æŒç±»å‹ï¼š**
- âœ… å•å›¾/å¤šå›¾å¸–å­
- âœ… è§†é¢‘å¸–å­/Reels
- âœ… æ··åˆç›¸å†Œï¼ˆå›¾ç‰‡+è§†é¢‘ï¼‰

## åŠŸèƒ½
- ä¸‹è½½ Instagram å›¾ç‰‡/è§†é¢‘
- ä¿å­˜åˆ° ~/Downloads/ins/
- è‡ªåŠ¨å‘é€åˆ° Telegram @xiaoxiaasbot

## âš ï¸ é™åˆ¶
**æœ¬å·¥å…·ä»…å¤„ç† Instagram é“¾æ¥**ï¼Œå…¶ä»–å¹³å°é“¾æ¥ï¼ˆTwitter/Xã€Facebook ç­‰ï¼‰ä¼šè¢«æ‹’ç»ã€‚

æ”¯æŒçš„é“¾æ¥æ ¼å¼ï¼š
- `https://www.instagram.com/p/xxxxx/` (å›¾ç‰‡/è§†é¢‘å¸–å­)
- `https://www.instagram.com/reel/xxxxx/` (Reels çŸ­è§†é¢‘)

## ä½¿ç”¨æ–¹å¼

### æ–¹å¼1ï¼šç›´æ¥å‘é€é“¾æ¥
å‘é€ Instagram é“¾æ¥ï¼Œè‡ªåŠ¨è§¦å‘ä¸‹è½½

### æ–¹å¼2ï¼šå‘½ä»¤è¡Œä¸‹è½½
```bash
# ä¸‹è½½
bash ~/.openclaw/skills/social/social-instagram/download.sh "https://www.instagram.com/p/xxxxx/"

# å‘é€å®Œæˆåæ¸…ç†ä¸´æ—¶æ–‡ä»¶
bash ~/.openclaw/skills/social/social-instagram/cleanup.sh <POST_ID>

# æˆ–æ¸…ç†æ‰€æœ‰æ—§ä¸´æ—¶æ–‡ä»¶ï¼ˆè¶…è¿‡1å°æ—¶çš„ï¼‰
bash ~/.openclaw/skills/social/social-instagram/cleanup.sh
```

## å·¥ä½œæµç¨‹

1. **æ£€æµ‹ç±»å‹**ï¼šè‡ªåŠ¨è¯†åˆ«å¸–å­æ˜¯å›¾ç‰‡è¿˜æ˜¯è§†é¢‘
2. **ä¸‹è½½**ï¼šä½¿ç”¨ `gallery-dl` æˆ– `yt-dlp` ä¸‹è½½åˆ° `~/Downloads/ins/`
3. **ä¸­è½¬**ï¼šå¤åˆ¶åª’ä½“æ–‡ä»¶åˆ° `~/.openclaw/workspace/temp/` ä¾› Telegram å‘é€
4. **å‘é€**ï¼šé€šè¿‡ Telegram å‘é€ç»™ç”¨æˆ·
5. **æ¸…ç†**ï¼šå‘é€å®Œæˆååˆ é™¤ `temp` ç›®å½•ä¸­çš„ä¸´æ—¶æ–‡ä»¶

### ä¸‹è½½ç­–ç•¥
- **å›¾ç‰‡**ï¼šä½¿ç”¨ gallery-dlï¼ˆç¨³å®šã€æ”¯æŒå¤šå›¾ç›¸å†Œï¼‰
- **è§†é¢‘**ï¼šä¼˜å…ˆ gallery-dlï¼Œå¤±è´¥æ—¶è‡ªåŠ¨å›é€€åˆ° yt-dlp

## ä¸´æ—¶æ–‡ä»¶è¯´æ˜

- **ä¸‹è½½ç›®å½•**ï¼š`~/Downloads/ins/`ï¼ˆæ°¸ä¹…ä¿å­˜å›¾ç‰‡å’Œè§†é¢‘ï¼‰
- **ä¸´æ—¶ç›®å½•**ï¼š`~/.openclaw/workspace/temp/`ï¼ˆå‘é€åè‡ªåŠ¨æ¸…ç†ï¼‰

**æ”¯æŒçš„æ–‡ä»¶ç±»å‹ï¼š**
- `.jpg` / `.jpeg` - å›¾ç‰‡æ–‡ä»¶
- `.mp4` - è§†é¢‘æ–‡ä»¶

**æ³¨æ„**ï¼šä¸´æ—¶æ–‡ä»¶ç”¨äº Telegram å‘é€ï¼Œå®Œæˆååº”ç«‹å³æ¸…ç†ä»¥é¿å…å †ç§¯ã€‚

## æ–‡ä»¶å‘½åè§„åˆ™

### ä¸‹è½½IDæ ¼å¼
```
{åšä¸»INSå·}_{YYYYMMDD}_{HHMMSS}
```

ç¤ºä¾‹ï¼š`designwanted_20260222_101216`

### æ–‡ä»¶åæ ¼å¼
```
{ä¸‹è½½ID}_{æœ¬æ¬¡ä¸‹è½½æ–‡ä»¶æ€»æ•°}_{æœ¬æ¬¡ä¸‹è½½é¡ºåºæ•°}.{æ‰©å±•å}
```

**ç¤ºä¾‹ï¼š**
- å•å›¾ï¼š`designwanted_20260222_101216_1_1.jpg`
- å¤šå›¾ç¬¬3å¼ ï¼š`designwanted_20260222_101216_10_3.jpg`ï¼ˆæ€»å…±10å¼ ï¼Œç¬¬3å¼ ï¼‰
- è§†é¢‘ï¼š`designwanted_20260222_101216_1_1.mp4`

**æ ¼å¼è¯´æ˜ï¼š**
- `{ä¸‹è½½ID}`ï¼šå”¯ä¸€æ ‡è¯†æœ¬æ¬¡ä¸‹è½½ä»»åŠ¡
- `{æ€»æ•°}`ï¼šæœ¬æ¬¡ä¸‹è½½çš„æ–‡ä»¶æ€»æ•°
- `{åºå·}`ï¼šå½“å‰æ–‡ä»¶åœ¨æ€»æ•°ä¸­çš„é¡ºåºï¼ˆä»1å¼€å§‹ï¼‰

## å®ŒæˆæŠ¥å‘Š

æ¯ä¸ªä¸‹è½½ä»»åŠ¡å®Œæˆåï¼Œè¾“å‡ºä¸‰ç§æ ¼å¼æŠ¥å‘Šï¼š

### 1. æ–‡æœ¬æ ¼å¼ï¼ˆå‘é€ç»™ Telegramï¼‰
```
ğŸ“¥ ä¸‹è½½å®ŒæˆæŠ¥å‘Š
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ†” ä¸‹è½½ID: username_20260222_101216
ğŸ“ å¸–å­é“¾æ¥: https://www.instagram.com/p/xxxxx/
ğŸ‘¤ ä½œè€…: @username

ğŸ“ åŸæ–‡å†…å®¹:
[å¸–å­å®Œæ•´è‹±æ–‡/å…¶ä»–è¯­è¨€å†…å®¹]

ğŸ“ ä¸­æ–‡ç¿»è¯‘:
[ç¿»è¯‘åçš„ä¸­æ–‡å†…å®¹]

ğŸ©· ç‚¹èµ: 179
ğŸ’¬ è¯„è®º: 12
â–¶ï¸  æ’­æ”¾: 1523 (ä»…è§†é¢‘)
ğŸ“‚ ä¸‹è½½åœ°å€: ~/Downloads/ins/
ğŸ“· å›¾ç‰‡æ•°é‡: 7 å¼ 
ğŸ¬ è§†é¢‘æ•°é‡: 0 ä¸ª
â±ï¸  ä¸‹è½½æ—¶é—´: 10:12:16 - 10:13:31 (1åˆ†15ç§’)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

### 2. Markdown æ ¼å¼ï¼ˆæ§åˆ¶å°è¾“å‡ºï¼Œä¸å‘é€ï¼‰

```markdown
# Instagram ä¸‹è½½æŠ¥å‘Š

**ä¸‹è½½ID**: `username_20260222_101216`  
**å¸–å­é“¾æ¥**: https://www.instagram.com/p/xxxxx/  
**ä½œè€…**: @username  
**ä¸‹è½½æ—¶é—´**: 2026-02-22 10:12:16 ~ 10:13:31 (1åˆ†15ç§’)

## å†…å®¹

**åŸæ–‡**:
[å¸–å­å®Œæ•´å†…å®¹]

**ä¸­æ–‡ç¿»è¯‘**:
[ç¿»è¯‘åçš„ä¸­æ–‡å†…å®¹]

## ç»Ÿè®¡æ•°æ®

| é¡¹ç›® | æ•°å€¼ |
|------|------|
| ç‚¹èµ | 179 |
| è¯„è®º | 12 |
| å›¾ç‰‡ | 7 å¼  |
| è§†é¢‘ | 0 ä¸ª |

**ä¸‹è½½åœ°å€**: `~/Downloads/ins/`
```

### 3. JSON æ ¼å¼ï¼ˆæ§åˆ¶å°è¾“å‡ºï¼Œä¸å‘é€ï¼‰

```json
{
  "download_id": "username_20260222_101216",
  "url": "https://www.instagram.com/p/xxxxx/",
  "author": "username",
  "caption_original": "[å¸–å­å®Œæ•´å†…å®¹]",
  "caption_translated": "[ç¿»è¯‘åçš„ä¸­æ–‡å†…å®¹]",
  "likes": 179,
  "comments": 12,
  "images": 7,
  "videos": 0,
  "download_path": "~/Downloads/ins/",
  "start_time": "2026-02-22T10:12:16",
  "end_time": "2026-02-22T10:13:31",
  "duration_seconds": 75
}
```

**å‘é€è§„åˆ™ï¼š** ä»…æ–‡æœ¬æ ¼å¼æŠ¥å‘Šå‘é€åˆ° Telegramï¼ŒMarkdown å’Œ JSON æ ¼å¼ä»…åœ¨æ§åˆ¶å°è¾“å‡ºå±•ç¤ºã€‚

## å…ƒæ•°æ®è®°å½•

æ¯ä¸ªä¸‹è½½çš„æ–‡ä»¶éƒ½ä¼šè®°å½•æ¥æºä¿¡æ¯ï¼š

### å›¾ç‰‡æ–‡ä»¶ (Python + Pillow EXIF)
ä½¿ç”¨ **Python Pillow** å°†å…ƒæ•°æ®å†™å…¥å›¾ç‰‡ EXIFï¼š
- **ImageDescription (0x010E)**: **ä¸‹è½½é“¾æ¥** (Instagram URL) â† ç”¨æˆ·è¦æ±‚çš„"æ³¨é‡Š"ä½ç½®
- **UserComment (0x9286)**: å®Œæ•´ JSON å…ƒæ•°æ®
- **Artist (0x0131)**: ä½œè€…ç”¨æˆ·å

### è§†é¢‘æ–‡ä»¶
ä½¿ç”¨ **ffmpeg** å°†å…ƒæ•°æ®åµŒå…¥æ–‡ä»¶å†…éƒ¨ï¼š
- `comment`: å®Œæ•´ JSON å…ƒæ•°æ®
- `description`: å¸–å­æ–‡å­—å†…å®¹
- `artist`: ä½œè€…ç”¨æˆ·å
- `title`: ä¸‹è½½ID

### è¯»å–å›¾ç‰‡ EXIF
```python
from PIL import Image
import json

img = Image.open("image.jpg")
exif = img.getexif()

# è¯»å–ä¸‹è½½é“¾æ¥ï¼ˆç”¨æˆ·è¦æ±‚çš„"æ³¨é‡Š"ä½ç½®ï¼‰
if 0x010E in exif:
    url = exif[0x010E]  # ImageDescription - ä¸‹è½½é“¾æ¥
    print(f"ä¸‹è½½é“¾æ¥: {url}")

# è¯»å–å®Œæ•´å…ƒæ•°æ®
if 0x9286 in exif:
    metadata = json.loads(exif[0x9286].decode('utf-8'))
    print(f"ä½œè€…: {metadata['author']}")
    print(f"ç‚¹èµ: {metadata['likes']}")
```

### å…ƒæ•°æ®å†…å®¹
```json
{
  "source_url": "https://www.instagram.com/p/xxxxx/",
  "download_id": "author_20260224_161218",
  "file_index": "3_1",
  "author": "username",
  "author_fullname": "Full Name",
  "caption": "å¸–å­å†…å®¹...",
  "likes": 1131,
  "post_date": "2026-02-12 11:39:25",
  "download_time": "2026-02-24T16:12:18"
}
```

### è¯»å–è§†é¢‘å…ƒæ•°æ®
```bash
# ä½¿ç”¨ ffprobe
~/.openclaw/ffprobe -v quiet -print_format json -show_format video.mp4 | jq '.format.tags'
```

## è¾“å‡ºç›®å½•
- æ°¸ä¹…å­˜å‚¨ï¼š`~/Downloads/ins/`
- ä¸´æ—¶ä¸­è½¬ï¼š`~/.openclaw/workspace/temp/`

## æ”¯æŒçš„åª’ä½“æ ¼å¼
| æ ¼å¼ | æ”¯æŒæƒ…å†µ | ä¸‹è½½å·¥å…· |
|------|---------|---------|
| JPG å›¾ç‰‡ | âœ… å®Œå…¨æ”¯æŒ | gallery-dl |
| MP4 è§†é¢‘ | âœ… å®Œå…¨æ”¯æŒ | gallery-dl / yt-dlp |
| Reels çŸ­è§†é¢‘ | âœ… æ”¯æŒ | gallery-dl |
| æ··åˆç›¸å†Œ | âœ… æ”¯æŒ | gallery-dl |
